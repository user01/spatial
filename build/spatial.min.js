var Spatial;!function(a){var b=function(){function a(b,c,d,e,f){var g=this;void 0===b&&(b=a.defaultEasingFunction),void 0===c&&(c=1),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=10),this._type=b,this._valueStart=c,this._valueEnd=d,this._rangeStart=e,this._rangeEnd=f,this.ValueAt=function(b){return a.ValueAtStatic(g,b)},this.Equal=function(b){return a.Equal(g,b)},this.SetType=function(b){return a.AlterValue(g,0,b)},this.SetValueStart=function(b){return a.AlterValue(g,1,b)},this.SetValueEnd=function(b){return a.AlterValue(g,2,b)},this.SetRangeStart=function(b){return a.AlterValue(g,3,b)},this.SetRangeEnd=function(b){return a.AlterValue(g,4,b)},this.ToArray=function(){return[g.Type,g.ValueStart,g.ValueEnd,g.RangeStart,g.RangeEnd]},this.ToObj=function(){return{vs:g._valueStart,ve:g._valueEnd,rs:g._rangeStart,re:g._rangeEnd,t:g._type}},this.ToStr=function(){return JSON.stringify(g.ToObj())},this.Clone=function(){return a.CloneRamp(g)},this._rangeStart>this._rangeEnd&&(this._rangeEnd=this._rangeStart),a.EasingFunctions[this._type]||(this._type=a.defaultEasingFunction)}return Object.defineProperty(a.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ValueStart",{get:function(){return this._valueStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ValueEnd",{get:function(){return this._valueEnd},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"RangeStart",{get:function(){return this._rangeStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"RangeEnd",{get:function(){return this._rangeEnd},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Duration",{get:function(){return this._rangeEnd-this._rangeStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ValueChange",{get:function(){return this._valueEnd-this._valueStart},enumerable:!0,configurable:!0}),a.defaultEasingFunction="easeOutQuad",a.FromArray=function(b){return new a(b[0],b[1],b[2],b[3],b[4])},a.AlterValue=function(b,c,d){var e=b.ToArray();return e[c]=d,a.FromArray(e)},a.FromObj=function(b){return new a(b.t,b.vs,b.ve,b.rs,b.re)},a.FromStr=function(b){return a.FromObj(JSON.parse(b))},a.CloneRamp=function(b){return a.FromObj(b.ToObj())},a.ValueAtStatic=function(b,c){if(c>=b.RangeEnd)return b.ValueEnd;if(c<=b.RangeStart)return b.ValueStart;var d=((c-b.RangeStart)/b.Duration,c-b._rangeStart);return a.Ease(b._type,d,b.ValueStart,b.ValueChange,b.Duration)},a.Equal=function(a,b){if(a._type!=b._type)return!1;var c=a._valueStart-b._valueStart+(a._valueEnd-b._valueEnd)+(a._rangeStart-b._rangeStart)+(a._rangeEnd-b._rangeEnd);return Math.abs(c)<.02},a.Build=function(b){return void 0===b&&(b=null),null==b?new a:"string"==typeof b?0==b.indexOf("{")?a.FromStr(b):new a(b):b},a.Mix=function(a,b,c,d){void 0===c&&(c=.5),void 0===d&&(d=0),c=Math.min(1,Math.max(0,c));var e=a.ValueAt(d),f=b.ValueAt(d),g=e*(1-c)+f*c;return g},a.Ease=function(b,c,d,e,f){void 0===b&&(b="easeOutQuad"),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=0),a.EasingFunctions.hasOwnProperty(b)||(b="easeOutQuad");var g=a.EasingFunctions[b](c,d,e,f);return isNaN(g)?d:g},a.EasingFunctions={linear:function(a,b,c,d){return c*(a/=d)+b},easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInCubic:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOutCubic:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},easeInOutCubic:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b},easeInQuart:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutQuart:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOutQuart:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOutQuint:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOutSine:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOutSine:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},easeInExpo:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return 0==a?b:a==d?b+c:(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return(a/=d/2)<1?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f))+b},easeOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return g*Math.pow(2,-10*a)*Math.sin(2*(a*d-e)*Math.PI/f)+c+b},easeInOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(2==(a/=d/2))return b+c;if(f||(f=.3*d*1.5),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return 1>a?-.5*g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)+b:g*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)*.5+c+b},easeInBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeOutBounce:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b}},a}();a.Ramp=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(){function b(c,d){var e=this;if(void 0===d&&(d=null),this.Clone=function(){return b.CloneStatic(e)},this.readableStr=function(){for(var a="V"+e.Dimension+"[",b=0;b<e._values.length;b++)a+=e._values[b]+",";return a+"]"},this.ToObj=function(){return{t:e.Dimension,v:e._values,r:e.Ramp.ToObj()}},this.ToStr=function(){return JSON.stringify(e.ToObj())},this.Equal=function(a){return b.EqualStatic(e,a)},this.DistanceTo=function(a){return b.DistanceToStatic(e,a)},this.IntensityAt=function(a){return e.Ramp.ValueAt(e.DistanceTo(a))},this.ClosestVector=function(a){return e.Clone()},c.length<1||c.length>4)throw new RangeException;this._ramp=a.Ramp.Build(d),this._values=new Float32Array(c)}return Object.defineProperty(b.prototype,"Values",{get:function(){return this._values},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Dimension",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Ramp",{get:function(){return this._ramp},enumerable:!0,configurable:!0}),b.FromObj=function(c){switch(c.t){case 2:return a.Vector2.FromObj(c);case 3:return a.Vector3.FromObj(c);case 4:return a.Vector4.FromObj(c)}return new b(c.v,a.Ramp.FromObj(c.r))},b.FromStr=function(a){return b.FromObj(JSON.parse(a))},b.DistanceToStatic=function(a,c){b.DimensionCheck(a,c);for(var d=0,e=0;e<a.Dimension;e++)d+=(a.Values[e]-c.Values[e])*(a.Values[e]-c.Values[e]);return Math.sqrt(d)},b.CloneStatic=function(a){return b.FromObj(a.ToObj())},b.Add=function(a,c){b.DimensionCheck(a,c);for(var d=new Array,e=0;e<a.Dimension;e++)d.push(a.Values[e]+c.Values[e]);return new b(d,a.Ramp.ToStr())},b.Subtract=function(a,c){return b.Add(a,b.Negate(c))},b.Scale=function(a,c){for(var d=new Array,e=0;e<a.Dimension;e++)d.push(a.Values[e]*c);return new b(d,a.Ramp.ToStr())},b.Negate=function(a){return b.Scale(a,-1)},b.EqualStatic=function(a,b){if(a.Dimension!=b.Dimension)return!1;if(!a.Ramp.Equal(b.Ramp))return!1;for(var c=0;c<a.Dimension;c++)if(Math.abs(a.Values[c]-b.Values[c])>.05)return!1;return!0},b.Dot=function(a,c){b.DimensionCheck(a,c);for(var d=0,e=0;e<a.Dimension;e++)d+=a.Values[e]*c.Values[e];return d},b.DimensionCheck=function(a,b){if(a.Dimension!=b.Dimension)throw new RangeException;return!0},b.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},b}();a.Vector=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(){function b(c,d,e){var f=this;if(void 0===e&&(e=null),this._base=c,this._tip=d,this.DistanceTo=function(a){return b.DistanceToStatic(f,a)},this.IntensityAt=function(b){var c=f.closestFraction(b);c=f.Ramp.ValueAt(c);var d=f.DistanceTo(b),e=a.Ramp.Mix(f.Base.Ramp,f.Tip.Ramp,c,d);return e},this.ClosestVector=function(a){var b=f.closestFraction(a),c=f.Scale(b);return c.Tip.Clone()},this.closestFraction=function(c){b.DimensionCheck(f,c);var d=f.Length;if(.001>d)return 0;var e=a.Vector.Subtract(c,f.Base),g=a.Vector.Dot(e,f.TipWithoutBase)/(d*d);return Math.max(0,Math.min(1,g))},this.RestoreBase=function(b){return a.Vector.Add(f.Base,b)},this.Push=function(a){return b.Push(f,a)},this.Scale=function(a){return b.Scale(f,a)},this.Equal=function(a){return b.EqualStatic(f,a)},this.ToObj=function(){return{t:f.Dimension,b:f.Base.ToObj(),e:f.Tip.ToObj(),r:f.Ramp.ToObj()}},this.ToStr=function(){return JSON.stringify(f.ToObj())},!this._base||!this._tip||this._base.Dimension!=this._tip.Dimension)throw new RangeException;var g=a.Ramp.Build(e);this._ramp=new a.Ramp(g.Type,0,1,0,1)}return Object.defineProperty(b.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TipWithoutBase",{get:function(){return a.Vector.Subtract(this._tip,this._base)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Length",{get:function(){return this._base.DistanceTo(this._tip)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Dimension",{get:function(){return this._tip.Dimension},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Ramp",{get:function(){return this._ramp},enumerable:!0,configurable:!0}),b.EqualStatic=function(a,b){return a.Tip.Equal(b.Tip)&&a.Base.Equal(b.Base)&&a.Ramp.Equal(b.Ramp)?!0:!1},b.Scale=function(c,d){var e=c.RestoreBase(a.Vector.Scale(c.TipWithoutBase,d));return new b(c.Base.Clone(),e)},b.Push=function(c,d){if(c.Dimension!=d.Dimension)throw new RangeException;return new b(a.Vector.Add(c.Base,d),a.Vector.Add(c.Tip,d))},b.DistanceToStatic=function(a,c){b.DimensionCheck(a,c);var d=a.ClosestVector(c);return d.DistanceTo(c)},b.DimensionCheck=function(a,b){if(a.Dimension!=b.Dimension)throw new RangeException;return!0},b.FromObj=function(c){switch(c.t){case 2:return new a.Segment2(a.Vector2.FromObj(c.b),a.Vector2.FromObj(c.e),a.Ramp.FromObj(c.r));case 3:return new a.Segment3(a.Vector3.FromObj(c.b),a.Vector3.FromObj(c.e),a.Ramp.FromObj(c.r));case 4:return new a.Segment4(a.Vector4.FromObj(c.b),a.Vector4.FromObj(c.e),a.Ramp.FromObj(c.r))}return new b(a.Vector.FromObj(c.b),a.Vector.FromObj(c.e),a.Ramp.FromObj(c.r))},b.FromStr=function(a){return b.FromObj(JSON.parse(a))},b}();a.Segment=b}(Spatial||(Spatial={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Spatial;!function(a){var b=function(b){function c(a,d,e){var f=this;void 0===e&&(e=null),b.call(this,a,d,e),this.Push=function(a){return c.Push(f,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),c.Push=function(b,c){return a.Segment.Push(b,c)},c}(a.Segment);a.Segment2=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,d,e){var f=this;void 0===e&&(e=null),b.call(this,a,d,e),this.Push=function(a){return c.Push(f,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"TipWithoutBase",{get:function(){return a.Vector.Subtract(this._tip,this._base)},enumerable:!0,configurable:!0}),c.Push=function(b,c){return a.Segment.Push(b,c)},c.Cross=function(b,d){var e=a.Vector3.Cast(b.TipWithoutBase.Clone()),f=a.Vector3.Cast(d.TipWithoutBase.Clone()),g=e.Cross(f),h=a.Vector3.Cast(b.RestoreBase(g));return new c(a.Vector3.Cast(b.Base),h)},c}(a.Segment);a.Segment3=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,d,e){var f=this;void 0===e&&(e=null),b.call(this,a,d,e),this.Push=function(a){return c.Push(f,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),c.Push=function(b,c){return a.Segment.Push(b,c)},c}(a.Segment);a.Segment4=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(){function b(a){var c=this;if(this.segments=a,this._dimension=0,this.DistanceTo=function(a){return c.closestVectorDistanceIntensity(a)[1]},this.IntensityAt=function(a){return c.closestVectorDistanceIntensity(a)[2]},this.ClosestVector=function(a){return c.closestVectorDistanceIntensity(a)[0]},this.Clone=function(){return b.CloneStatic(c)},this.Equal=function(a){return b.EqualStatic(c,a)},this.ToObj=function(){return{s:c.segments.map(function(a){return a.ToObj()})}},this.ToStr=function(){return JSON.stringify(c.ToObj())},this.closestVectorDistanceIntensity=function(a){for(var b=null,d=Number.MAX_VALUE,e=0,f=0;f<c.segments.length;f++){var g=c.segments[f].ClosestVector(a),h=c.segments[f].DistanceTo(a);(null==b||d>h)&&(b=g,d=h,e=c.segments[f].IntensityAt(g))}return[b,d,e]},void 0===a||a.length<1)throw new RangeException;this._dimension=a[0].Dimension;for(var d=0;d<this.segments.length;d++)if(a[d].Dimension!=this._dimension)throw new RangeException}return Object.defineProperty(b.prototype,"Dimension",{get:function(){return this._dimension},enumerable:!0,configurable:!0}),b.FromObj=function(c){var d=c.s.map(function(b){return a.Segment.FromObj(b)});return new b(d)},b.FromStr=function(a){return b.FromObj(JSON.parse(a))},b.CloneStatic=function(a){return b.FromObj(a.ToObj())},b.EqualStatic=function(a,b){if(a.segments.length!=b.segments.length)return!1;for(var c=0;c<a.segments.length;c++)if(!a.segments[c].Equal(b.segments[c]))return!1;return!0},b.Merge=function(a,c){if(a.Dimension!=c.Dimension)throw new RangeException;return new b(a.segments.concat(c.segments))},b}();a.SegmentSet=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,c,d){void 0===d&&(d=null),b.call(this,[a,c],d)}return __extends(c,b),Object.defineProperty(c.prototype,"x",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return this._values[1]},enumerable:!0,configurable:!0}),c.FromObj=function(b){return new c(b.v[0],b.v[1],a.Ramp.FromObj(b.r))},c.FromStr=function(a){return c.FromObj(JSON.parse(a))},c.Build=function(a){if(2!=a.length)throw new RangeException;return new c(a[0],a[1])},c}(a.Vector);a.Vector2=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,d,e,f){var g=this;void 0===f&&(f=null),b.call(this,[a,d,e],f),this.Cross=function(a){return c.CrossStatic(g,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"x",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return this._values[1]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"z",{get:function(){return this._values[2]},enumerable:!0,configurable:!0}),c.CrossStatic=function(a,b){var d=a.y*b.z-a.z*b.y,e=a.z*b.x-a.x*b.z,f=a.x*b.y-a.y*b.x;return new c(d,e,f,a.Ramp.Clone())},c.Cast=function(a){if(3!=a.Values.length)throw new RangeException;return new c(a.Values[0],a.Values[1],a.Values[2],a.Ramp)},c.FromObj=function(b){return new c(b.v[0],b.v[1],b.v[2],a.Ramp.FromObj(b.r))},c.FromStr=function(a){return c.FromObj(JSON.parse(a))},c.Build=function(a){if(3!=a.length)throw new RangeException;return new c(a[0],a[1],a[2])},c}(a.Vector);a.Vector3=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,c,d,e,f){void 0===f&&(f=null),b.call(this,[a,c,d,e],f)}return __extends(c,b),Object.defineProperty(c.prototype,"x",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return this._values[1]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"z",{get:function(){return this._values[2]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"w",{get:function(){return this._values[3]},enumerable:!0,configurable:!0}),c.FromObj=function(b){return new c(b.v[0],b.v[1],b.v[2],b.v[3],a.Ramp.FromObj(b.r))},c.FromStr=function(a){return c.FromObj(JSON.parse(a))},c.Build=function(a){if(4!=a.length)throw new RangeException;return new c(a[0],a[1],a[2],a[3])},c}(a.Vector);a.Vector4=b}(Spatial||(Spatial={}));