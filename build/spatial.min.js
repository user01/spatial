var Spatial;!function(a){var b=function(){function a(b,c,d,e,f){var g=this;void 0===b&&(b="easeOutQuad"),void 0===c&&(c=1),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=10),this.type=b,this.valueStart=c,this.valueEnd=d,this.rangeStart=e,this.rangeEnd=f,this.valueChange=0,this.duration=0,this.valueAt=function(b){return a.ValueAt(g,b)},this.equal=function(b){return a.Equal(g,b)},this.toObj=function(){return{vs:g.valueStart,ve:g.valueEnd,rs:g.rangeStart,re:g.rangeEnd,t:g.type}},this.toStr=function(){return JSON.stringify(g.toObj())},this.rangeStart=Math.abs(this.rangeStart),this.rangeEnd=Math.abs(this.rangeEnd),this.rangeStart>this.rangeEnd&&(this.rangeEnd=this.rangeStart),this.duration=Math.abs(this.rangeEnd-this.rangeStart),this.valueChange=this.valueEnd-this.valueStart}return a.fromObj=function(b){return new a(b.t,b.vs,b.ve,b.rs,b.re)},a.fromStr=function(b){return a.fromObj(JSON.parse(b))},a.ValueAt=function(b,c){if(c=Math.abs(c),c>=b.rangeEnd)return b.valueEnd;if(c<=b.rangeStart)return b.valueStart;var d=((c-b.rangeStart)/(b.rangeEnd-b.rangeStart),c-b.rangeStart);return a.Ease(b.type,d,b.valueStart,b.valueChange,b.duration)},a.Equal=function(a,b){if(a.type!=b.type)return!1;var c=a.valueStart-b.valueStart+(a.valueEnd-b.valueEnd)+(a.rangeStart-b.rangeStart)+(a.rangeEnd-b.rangeEnd);return Math.abs(c)<.02},a.Build=function(b){return void 0===b&&(b=null),null==b?new a:"string"==typeof b?a.fromStr(b):b},a.Mix=function(a,b,c,d){void 0===c&&(c=.5),void 0===d&&(d=0),c=Math.min(1,Math.max(0,c));var e=a.valueAt(d),f=b.valueAt(d),g=e*(1-c)+f*c;return g},a.Ease=function(b,c,d,e,f){void 0===b&&(b="easeOutQuad"),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=0),a.EasingFunctions.hasOwnProperty(b)||(b="easeOutQuad");var g=a.EasingFunctions[b](c,d,e,f);return isNaN(g)?d:g},a.EasingFunctions={linear:function(a,b,c,d){return c*(a/=d)+b},easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInCubic:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOutCubic:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},easeInOutCubic:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b},easeInQuart:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutQuart:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOutQuart:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOutQuint:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOutSine:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOutSine:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},easeInExpo:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return 0==a?b:a==d?b+c:(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return(a/=d/2)<1?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f))+b},easeOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return g*Math.pow(2,-10*a)*Math.sin(2*(a*d-e)*Math.PI/f)+c+b},easeInOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(2==(a/=d/2))return b+c;if(f||(f=.3*d*1.5),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return 1>a?-.5*g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)+b:g*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)*.5+c+b},easeInBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeOutBounce:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b}},a}();a.Ramp=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(){function b(c,d){var e=this;if(void 0===d&&(d=null),this.clone=function(){return b.Clone(e)},this.readableStr=function(){for(var a="V"+e.dimension+"[",b=0;b<e._values.length;b++)a+=e._values[b]+",";return a+"]"},this.toObj=function(){return{t:"v"+e.dimension,v:e._values,r:e.ramp.toStr()}},this.toStr=function(){return JSON.stringify(e.toObj())},this.equal=function(a){return b.Equal(e,a)},this.distanceTo=function(a){return b.DistanceTo(e,a)},this.intensityAt=function(a){return e.ramp.valueAt(e.distanceTo(a))},this.closestVector=function(){return e.clone()},c.length<1||c.length>4)throw new RangeException;this._ramp=a.Ramp.Build(d),this._values=new Float32Array(c)}return Object.defineProperty(b.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"dimension",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ramp",{get:function(){return this._ramp},enumerable:!0,configurable:!0}),b.fromObj=function(a){return new b(a.v)},b.fromStr=function(a){return b.fromObj(JSON.parse(a))},b.DistanceTo=function(a,c){b.DimensionCheck(a,c);for(var d=0,e=0;e<a.dimension;e++)d+=(a.values[e]-c.values[e])*(a.values[e]-c.values[e]);return Math.sqrt(d)},b.Clone=function(a){return b.fromObj(a.toObj())},b.Add=function(a,c){b.DimensionCheck(a,c);for(var d=new Array,e=0;e<a.dimension;e++)d.push(a.values[e]+c.values[e]);return new b(d,a.ramp.toStr())},b.Subtract=function(a,c){return b.Add(a,b.Negate(c))},b.Scale=function(a,c){for(var d=new Array,e=0;e<a.dimension;e++)d.push(a.values[e]*c);return new b(d,a.ramp.toStr())},b.Negate=function(a){return b.Scale(a,-1)},b.Equal=function(a,b){if(a.dimension!=b.dimension)return!1;if(!a.ramp.equal(b.ramp))return!1;for(var c=0;c<a.dimension;c++)if(Math.abs(a.values[c]-b.values[c])>.05)return!1;return!0},b.Dot=function(a,c){b.DimensionCheck(a,c);for(var d=0,e=0;e<a.dimension;e++)d+=a.values[e]*c.values[e];return d},b.DimensionCheck=function(a,b){if(a.dimension!=b.dimension)throw new RangeException;return!0},b.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},b}();a.Vector=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(){function b(c,d,e){var f=this;if(void 0===e&&(e=null),this._base=c,this._tip=d,this.distanceTo=function(a){return b.DistanceTo(f,a)},this.intensityAt=function(b){var c=f.closestFraction(b);c=f.Ramp.valueAt(c);var d=f.distanceTo(b),e=a.Ramp.Mix(f.Base.ramp,f.Tip.ramp,c,d);return e},this.closestVector=function(a){var b=f.closestFraction(a),c=f.scale(b);return c.Tip.clone()},this.closestFraction=function(c){b.DimensionCheck(f,c);var d=f.length;if(.001>d)return 0;var e=a.Vector.Subtract(c,f.Base),g=a.Vector.Dot(e,f.TipWithoutBase)/(d*d);return Math.max(0,Math.min(1,g))},this.restoreBase=function(b){return a.Vector.Add(f.Base,b)},this.push=function(a){return b.Push(f,a)},this.scale=function(a){return b.Scale(f,a)},this.equal=function(a){return b.Equal(f,a)},this.toObj=function(){return{t:"s"+f.dimension,b:f.Base.toObj(),e:f.Tip.toObj(),r:f.Ramp.toObj()}},this.toStr=function(){return JSON.stringify(f.toObj())},!this._base||!this._tip||this._base.dimension!=this._tip.dimension)throw new RangeException;var g=a.Ramp.Build(e);this._ramp=new a.Ramp(g.type,0,1,0,1)}return Object.defineProperty(b.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TipWithoutBase",{get:function(){return a.Vector.Subtract(this._tip,this._base)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"length",{get:function(){return this._base.distanceTo(this._tip)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"dimension",{get:function(){return this._tip.dimension},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Ramp",{get:function(){return this._ramp},enumerable:!0,configurable:!0}),b.Equal=function(a,b){return a.Tip.equal(b.Tip)&&a.Base.equal(b.Base)&&a.Ramp.equal(b.Ramp)?!0:!1},b.Scale=function(c,d){var e=c.restoreBase(a.Vector.Scale(c.TipWithoutBase,d));return new b(c.Base.clone(),e)},b.Push=function(c,d){if(c.dimension!=d.dimension)throw new RangeException;return new b(a.Vector.Add(c.Base,d),a.Vector.Add(c.Tip,d))},b.DistanceTo=function(a,c){b.DimensionCheck(a,c);var d=a.closestVector(c);return d.distanceTo(c)},b.DimensionCheck=function(a,b){if(a.dimension!=b.dimension)throw new RangeException;return!0},b.fromObj=function(c){return new b(a.Vector.fromObj(c.b),a.Vector.fromObj(c.e),a.Ramp.fromObj(c.r))},b.fromStr=function(a){return b.fromObj(JSON.parse(a))},b}();a.Segment=b}(Spatial||(Spatial={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Spatial;!function(a){var b=function(b){function c(a,d){var e=this;b.call(this,a,d),this.push=function(a){return c.Push(e,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),c.Push=function(b,c){return a.Segment.Push(b,c)},c}(a.Segment);a.Segment2=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,d){var e=this;b.call(this,a,d),this.push=function(a){return c.Push(e,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),c.Push=function(b,c){return a.Segment.Push(b,c)},c}(a.Segment);a.Segment3=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(b){function c(a,d){var e=this;b.call(this,a,d),this.push=function(a){return c.Push(e,a)}}return __extends(c,b),Object.defineProperty(c.prototype,"Base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Tip",{get:function(){return this._tip},enumerable:!0,configurable:!0}),c.Push=function(b,c){return a.Segment.Push(b,c)},c}(a.Segment);a.Segment4=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(){function a(a){var b=this;if(this.segments=a,this._dimension=0,this.distanceTo=function(a){return b.closestVectorDistanceIntensity(a)[1]},this.intensityAt=function(a){return b.closestVectorDistanceIntensity(a)[2]},this.closestVector=function(a){return b.closestVectorDistanceIntensity(a)[0]},this.closestVectorDistanceIntensity=function(a){for(var c=null,d=Number.MAX_VALUE,e=0,f=0;f<b.segments.length;f++){var g=b.segments[f].closestVector(a),h=b.segments[f].distanceTo(a);(null==c||d>h)&&(c=g,d=h,e=b.segments[f].intensityAt(g))}return[c,d,e]},void 0===a||a.length<1)throw new RangeException;this._dimension=a[0].dimension;for(var c=0;c<this.segments.length;c++)if(a[c].dimension!=this._dimension)throw new RangeException}return Object.defineProperty(a.prototype,"dimension",{get:function(){return this._dimension},enumerable:!0,configurable:!0}),a}();a.SegmentSet=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(a){function b(b,c,d){void 0===d&&(d=null),a.call(this,[b,c],d)}return __extends(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._values[1]},enumerable:!0,configurable:!0}),b.fromObj=function(a){return new b(a.v[0],a.v[1])},b.fromStr=function(a){return b.fromObj(JSON.parse(a))},b.build=function(a){if(2!=a.length)throw new RangeException;return new b(a[0],a[1])},b}(a.Vector);a.Vector2=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(a){function b(b,c,d,e){void 0===e&&(e=null),a.call(this,[b,c,d],e)}return __extends(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._values[1]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this._values[2]},enumerable:!0,configurable:!0}),b.fromObj=function(a){return new b(a.v[0],a.v[1],a.v[2])},b.fromStr=function(a){return b.fromObj(JSON.parse(a))},b.build=function(a){if(3!=a.length)throw new RangeException;return new b(a[0],a[1],a[2])},b}(a.Vector);a.Vector3=b}(Spatial||(Spatial={}));var Spatial;!function(a){var b=function(a){function b(b,c,d,e,f){void 0===f&&(f=null),a.call(this,[b,c,d,e],f)}return __extends(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this._values[0]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._values[1]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this._values[2]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"w",{get:function(){return this._values[3]},enumerable:!0,configurable:!0}),b.fromObj=function(a){return new b(a.v[0],a.v[1],a.v[2],a.v[3])},b.fromStr=function(a){return b.fromObj(JSON.parse(a))},b.build=function(a){if(4!=a.length)throw new RangeException;return new b(a[0],a[1],a[2],a[3])},b}(a.Vector);a.Vector4=b}(Spatial||(Spatial={}));